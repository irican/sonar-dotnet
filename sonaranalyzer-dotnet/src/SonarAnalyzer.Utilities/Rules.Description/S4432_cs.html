<p>加密算法可以用于各种模式。有些组合并不安全：</p>
<ul>
  <li> 电子码本(ECB)模式:在给定密钥下，任何给定的明文块总是被加密到相同的密文块。因此，它不能很好地隐藏数据模式。从某种意义上说，
  它不提供严重的消息机密性，并且根本不建议在加密协议中使用它。</li>
  <li> 使用PKCS#5填充(或PKCS#7)的密码块链接(CBC)容易受到填充oracle攻击。如果将CBC + PKCS#7与密码文本的真实性检查(例如，HMAC-SHA256)结合使用，则可以使用CBC + PKCS#7。</li>
</ul>
<p>在这两种情况下，没有填充的Galois/Counter模式(GCM)都应该是首选。由于.NET 框架本身不提供此功能，因此建议使用经过认证的第三方库。</p>
<p>当检测到下列任何一种加密模式时（ECB, CBC, OFB, CFB, CTS），此规则将引发一个问题。</p>
<h2>不合规的代码示例</h2>
<pre>
AesManaged aes = new AesManaged
{
  KeySize = 128,
  BlockSize = 128,
  Mode = CipherMode.OFB, // 不合规
  Padding = PaddingMode.PKCS7
};
</pre>
<h2>请参阅</h2>
<ul>
  <li> <a href="http://cwe.mitre.org/data/definitions/327.html">MITRE, CWE-327</a> - Use of a Broken or Risky Cryptographic Algorithm </li>
  <li> OWASP Top 10 2017 Category A6 - Security Misconfiguration </li>
  <li> <a href="https://www.securecoding.cert.org/confluence/x/VwAZAg">CERT, MSC61-J.</a> - Do not use insecure or weak cryptographic algorithms </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
  <li> <a href="http://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38a.pdf">Recommendation for Block Cipher Modes of Operation</a>
  </li>
  <li> Derived from FindSecBugs rule <a href="https://find-sec-bugs.github.io/bugs.htm#ECB_MODE">ECB_MODE</a> </li>
  <li> Derived from FindSecBugs rule <a href="https://find-sec-bugs.github.io/bugs.htm#PADDING_ORACLE">PADDING_ORACLE</a> </li>
</ul>

