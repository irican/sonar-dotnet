<p>类字段事件（field-like events）指的是没有显式的 <code>add</code> 和 <code>remove</code> 的方法的事件。编译器会生成一个<code>private</code> 类的 <code>delegate</code> 字段支持这个事件，以及隐式的 <code>add</code> 和 <code>remove</code> 方法。</p>
<p>当一个 <code>virtual</code> 的类字段 <code>event</code> 被另一个类字段 <code>event</code> 重写时，C#编译器的行为是在派生类中生成一个新的 <code>private</code> 型的 <code>delegate</code> 字段，以区别于父类里的字段。其结果是创建了多个单独的事件，而这几乎肯定不是编写者的真实意图。</p>
<p>为避免这种情况，请删除父类事件的 <code>virtual</code> 修饰符。</p>
<h2>不合规的代码示例</h2>
<pre>
abstract class Car
{
  public virtual event EventHandler OnRefueled; // 不合规

  public void Refuel()
  {
    // OnRefueld总是为null
     if (OnRefueled != null)
     {
       OnRefueled(this, null);
     }
  }
}

class R2 : Car
{
  public override event EventHandler OnRefueled;
}

class Program
{
  static void Main(string[] args)
  {
    var r2 = new R2();
    r2.OnRefueled += new EventHandler((o, a) =&gt;
    {
      Console.WriteLine("This event will never be called");
    });
    r2.Refuel();
  }
}
</pre>
<h2>合规的解决方案</h2>
<pre>
abstract class Car
{
  public event EventHandler OnRefueled; // 合规

  public void Refuel()
  {
    if (OnRefueled != null)
    {
      OnRefueled(this, null);
    }
  }
}

class R2 : Car {}

class Program
{
  static void Main(string[] args)
  {
    var r2 = new R2();
    r2.OnRefueled += new EventHandler((o, a) =&gt;
    {
      Console.WriteLine("This event will be called");
    });
    r2.Refuel();
  }
}
</pre>

