<p>未经身份验证的LDAP连接可能导致没有访问控制的事务。身份验证及其访问控制是针对LDAP注入的最后一道防线，不应该禁用。</p>
<p>当使用<code>AuthenticationTypes.Anonymous</code>或<code>AuthenticationTypes.None</code>创建LDAP连接时，此规则会引发一个问题。</p>
<h2>不合规的代码示例</h2>
<pre>
DirectoryEntry myDirectoryEntry = new DirectoryEntry(adPath);
myDirectoryEntry.AuthenticationType = AuthenticationTypes.None; // 不合规

DirectoryEntry myDirectoryEntry = new DirectoryEntry(adPath, "u", "p", AuthenticationTypes.None); // 不合规
</pre>
<h2>合规的解决方案</h2>
<pre>
DirectoryEntry myDirectoryEntry = new DirectoryEntry(myADSPath); // 合规的；自.NET Framework 2.0以来，默认 DirectoryEntry.AuthenticationType 属性值是"安全的" 

DirectoryEntry myDirectoryEntry = new DirectoryEntry(myADSPath, "u", "p", AuthenticationTypes.Secure);
</pre>
<h2>请参阅</h2>
<ul>
  <li> <a href="https://cwe.mitre.org/data/definitions/521.html">CWE-521</a> - Weak Password Requirements </li>
  <li> OWASP Top 10 2017 Category A2 - Broken Authentication </li>
  <li> <a href="https://docs.oracle.com/javase/tutorial/jndi/ldap/authentication.html">Modes of Authenticating to LDAP</a> </li>
  <li> Derived from FindSecBugs rule <a href="https://find-sec-bugs.github.io/bugs.htm#LDAP_ANONYMOUS">LDAP_ANONYMOUS</a> </li>
</ul>

