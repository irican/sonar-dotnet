<p>数组协变（array covariance）指的是这样的一条原则：如果从类型 <code>A</code> 到 <code>B</code> 存在显式或隐式的引用转换。那么从数组 <code>A[]</code> 到 <code>B[]</code> 也有相同的转换。</p>
<p>虽然这种数组间的类型转换在只读情况下可用于将 <code>A[]</code> 的实例传递给 <code>B[]</code> ，但在使用时必须要小心，因为如果将 <code>B</code> 的实例传给 <code>A</code> 的数组会导致在运行时抛出 <code>ArrayTypeMismatchException</code> 。</p>
<h2>不合规的代码示例</h2>
<pre>
abstract class Fruit { }
class Apple : Fruit { }
class Orange : Fruit { }

class Program
{
  static void Main(string[] args)
  {
    Fruit[] fruits = new Apple[1]; // 不合规，使用了数组协变
    FillWithOranges(fruits);
  }

  // 仅凭观察代码发现不了可疑的地方
  static void FillWithOranges(Fruit[] fruits)
  {
    for (int i = 0; i &lt; fruits.Length; i++)
    {
      fruits[i] = new Orange(); // 会抛出 ArrayTypeMismatchException
    }
  }
}
</pre>
<h2>合规的解决方案</h2>
<pre>
abstract class Fruit { }
class Apple : Fruit { }
class Orange : Fruit { }

class Program
{
  static void Main(string[] args)
  {
    Orange[] fruits = new Orange[1]; // 合规
    FillWithOranges(fruits);
  }

  static void FillWithOranges(Orange[] fruits)
  {
    for (int i = 0; i &lt; fruits.Length; i++)
    {
      fruits[i] = new Orange();
    }
  }
}
</pre>

