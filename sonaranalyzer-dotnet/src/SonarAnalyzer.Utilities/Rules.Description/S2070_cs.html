<p>MD5算法及其后继算法sha-1不再被认为是安全的，因为使用它们很容易会发生hash碰撞。这也就是说，只需要很小的运算量就能由一个不同的输入产生一个相同的MD5或者SHA-1的hash。借助这个新产生的hash值，攻击者能像拥有原hash值一样获得同样的权限。其他的消息摘要算法也是这样：MD2，MD4，MD6。</p>
<p>此规则跟踪 <code>System.Security.Cryptography.CryptoConfig.CreateFromName()</code> 和 <code>System.Security.Cryptography.HashAlgorithm.Create()</code> 方法的使用，后者用于实例化MD5、DSA、HMACMD5、HMACRIPEMD160、RIPEMD-160和SHA-1算法。此规则还会跟踪 <code>System.Security.Cryptography.SHA1</code> 和 <code>System.Security.Cryptography.MD5</code>的派生类的实例。</p>
<p>建议考虑使用更安全的算法，如SHA-256或SHA-3。</p>
<h2>不合规的代码示例</h2>
<pre>
var hashProvider1 = new MD5CryptoServiceProvider(); //不合规
var hashProvider2 = (HashAlgorithm)CryptoConfig.CreateFromName("MD5"); //不合规
var hashProvider3 = new SHA1Managed(); //不合规
var hashProvider4 = HashAlgorithm.Create("SHA1"); //不合规
</pre>
<h2>合规的解决方案</h2>
<pre>
var hashProvider1 = new SHA256Managed();
var hashProvider2 = (HashAlgorithm)CryptoConfig.CreateFromName("SHA256Managed");
var hashProvider3 = HashAlgorithm.Create("SHA256Managed");
</pre>
<h2>请参阅</h2>
<ul>
  <li> <a href="http://cwe.mitre.org/data/definitions/328">MITRE, CWE-328</a> - Reversible One-Way Hash </li>
  <li> <a href="http://cwe.mitre.org/data/definitions/327">MITRE, CWE-327</a> - Use of a Broken or Risky Cryptographic Algorithm </li>
  <li> OWASP Top 10 2017 Category A6 - Security Misconfiguration </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
  <li> <a href="http://shattered.io/">SHAttered</a> - The first concrete collision attack against SHA-1. </li>
</ul>

